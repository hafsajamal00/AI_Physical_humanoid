# Research: Module 2 – The Digital Twin (Gazebo & Unity)

**Feature**: 002-digital-twin-module
**Date**: 2025-12-26
**Purpose**: Resolve technical decisions and unknowns before content authoring

---

## Decision 1: Content Structure and Chapter Organization

**Question**: How should Module 2 content be organized in Docusaurus to ensure clear progression and easy navigation?

**Research Findings**:
- Module 1 uses 3-chapter structure (ROS 2 Fundamentals, Communication, URDF) with independent testability
- Each chapter averages 600-800 words conceptual content
- Docusaurus autogenerated sidebar works well for linear progression
- "Explain-Show-Apply" pattern proven effective in Module 1

**Decision**: 3-chapter structure mirroring Module 1 pattern
- **Chapter 1**: Digital Twin Fundamentals (concept, sim vs real-world, Gazebo vs Unity)
- **Chapter 2**: Gazebo Physics Simulation (physics engine, environments, validation)
- **Chapter 3**: Sensors and Unity HRI (sensor plugins, Unity rendering, HRI scenarios)

**Rationale**:
- Maintains consistency with Module 1 structure (readers recognize pattern)
- Each chapter independently testable (P1 = MVP, P2/P3 = incremental value)
- 3-chapter length appropriate for 30-40 page Module 2 scope

**Alternatives Considered**:
- 2-chapter structure (Fundamentals + Combined Gazebo/Unity) - rejected, too dense
- 4-chapter structure (separate Gazebo from Unity entirely) - rejected, redundant content
- Flat structure without chapters - rejected, harder to navigate

---

## Decision 2: Diagram Strategy for Simulation Concepts

**Question**: How should simulation workflows and architectures be visualized to maximize comprehension without installation requirements?

**Research Findings**:
- Mermaid diagrams work well for workflows (perception-decision-action loop in Module 1)
- Static PNG/SVG needed for complex architectural diagrams (nervous system analogy in Module 1)
- Conceptual diagrams must avoid implementation details (no code snippets in diagrams)
- Simulation workflows inherently multi-step and benefit from flowcharts

**Decision**: Hybrid Mermaid + Static Image Approach
- **Mermaid for workflows**: Digital twin lifecycle, simulation loop, sensor data flow
- **Static images for architectures**: Gazebo physics engine components, Unity rendering pipeline
- **Conceptual annotations**: Label diagrams with "what" not "how" (e.g., "Physics Engine" not "ODE solver class")

**Rationale**:
- Mermaid version-controlled (text-based, easy to update)
- Static images handle complex layered architectures Mermaid can't express
- Avoids implementation details (stays conceptual)

**Alternatives Considered**:
- All Mermaid - rejected, can't express layered 3D concepts (Unity rendering pipeline)
- All static images - rejected, harder to version control and update
- Interactive diagrams (D3.js) - rejected, adds complexity, out of scope for conceptual module

---

## Decision 3: External References and Link Strategy

**Question**: How should we reference Gazebo/Unity documentation given rapid version changes and link rot risks?

**Research Findings**:
- Gazebo has Fortress (latest stable) and Classic (legacy) - both maintained
- Unity Robotics Hub has stable docs at https://github.com/Unity-Technologies/Unity-Robotics-Hub
- ROS 2 Gazebo plugins documented at https://github.com/ros-simulation/gazebo_ros_pkgs
- Academic sim-to-real papers provide timeless concepts (domain randomization, system ID)

**Decision**: Stable URL Strategy with Version Context
- Link to **official stable docs**: Gazebo Fortress docs, Unity Robotics Hub GitHub
- **Annotate version context**: "Gazebo Fortress (2023+)" vs "Gazebo Classic (pre-2023)"
- **Prefer concept-focused links**: Documentation sections on physics engines, not installation guides
- **Academic papers for theory**: Cite sim-to-real transfer papers (stable DOIs)

**Rationale**:
- Official docs have redirects (lower link rot risk)
- Version context prevents confusion when readers use different versions
- Concept links age better than installation guides (which change frequently)

**Alternatives Considered**:
- No external links (only internal content) - rejected, readers need official docs for hands-on future modules
- Link to installation guides - rejected, out of scope and high link rot risk
- Mirror documentation locally - rejected, copyright issues and maintenance burden

---

## Decision 4: Sim-to-Real Gap Coverage Depth

**Question**: How deeply should we cover sim-to-real transfer challenges given this is a conceptual module (no hands-on exercises)?

**Research Findings**:
- Sim-to-real gap is critical risk (readers may over-trust simulation)
- Domain randomization and system identification are standard mitigation strategies
- Specific failure modes (friction modeling, soft contact, sensor noise) illustrate gap concretely
- Hands-on sim-to-real tuning deferred to future advanced modules

**Decision**: Explicit Coverage in Chapter 1 + Reinforcement in Chapter 2/3
- **Chapter 1**: Dedicated section on sim-to-real gap with failure mode examples
- **Chapter 2**: Validation section discusses physics fidelity limits (friction, contact)
- **Chapter 3**: Sensor simulation section discusses synthetic data limitations (noise, artifacts)
- **Tone**: Simulation as "rapid iteration tool" not "hardware replacement"

**Rationale**:
- Prevents over-confidence in simulation results
- Prepares readers for hardware debugging (when sim doesn't match reality)
- Sets expectations without discouraging simulation use

**Alternatives Considered**:
- Minimal coverage (only mention gap exists) - rejected, readers may waste time debugging hardware
- Deep technical coverage (physics engine internals) - rejected, out of scope for conceptual module
- Defer entirely to hands-on module - rejected, risk mitigation needed upfront

---

## Decision 5: Gazebo vs Unity Comparison Framework

**Question**: How should we present Gazebo vs Unity to help readers choose the right tool?

**Research Findings**:
- Gazebo: Physics-first (ODE/Bullet engines), ROS 2 native integration, lower visual fidelity
- Unity: Rendering-first (Unity Engine), requires ROS 2 bridge, photorealistic visuals
- Use case determines choice: control algorithms → Gazebo, HRI demos/user studies → Unity
- Some projects use both (Gazebo for physics, Unity for visualization)

**Decision**: Decision Matrix in Chapter 1
- **Comparison Table**: Physics accuracy, visual fidelity, ROS 2 integration, use cases
- **Decision Flowchart (conceptual)**: "Testing control algorithm?" → Gazebo, "Presenting to humans?" → Unity
- **Hybrid Example**: Mention projects using both (Gazebo physics, Unity rendering)

**Rationale**:
- Clear criteria prevent tool choice confusion (Risk 2 in spec)
- Flowchart provides actionable guidance
- Acknowledges both tools have strengths (no "one true simulator")

**Alternatives Considered**:
- Recommend one tool only - rejected, both have valid use cases
- Defer choice to reader - rejected, leads to wasted setup effort
- Technical benchmarks - rejected, out of scope and hardware-dependent

---

## Summary of Resolved Decisions

| Decision | Choice | Impact |
|----------|--------|--------|
| Content Structure | 3-chapter structure (Fundamentals, Gazebo, Sensors/Unity) | Maintains Module 1 consistency, independent testability |
| Diagram Strategy | Hybrid Mermaid + Static Images | Version-controlled workflows, complex architectures visualized |
| External Links | Stable URLs with version context | Reduces link rot, provides official reference paths |
| Sim-to-Real Coverage | Explicit in Ch1, reinforced in Ch2/3 | Manages expectations, prevents over-trust in simulation |
| Gazebo vs Unity | Decision matrix + flowchart in Ch1 | Clear tool selection guidance, reduces setup waste |

**Next Phase**: Phase 1 Design - Create data-model.md, content contracts (chapter outlines), and quickstart.md based on these research decisions.
